<template>
  <div>
    <div class="map-contain">
          <h1>Verzameling rond de wereld!</h1>
      <div class="map-static">
        <svg
          width="815px"
          height="416px"
          viewBox="0 0 815 416"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
        >
          <!-- Generator: Sketch 52.2 (67145) - http://www.bohemiancoding.com/sketch -->
          <title>Group 13</title>
          <desc>Created with Sketch.</desc>
          <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="1-main" transform="translate(-308.000000, -252.000000)">
              <g id="Group-13" transform="translate(308.000000, 253.000000)">
                <g id="Noord-Amerika" v-on:click="targeted">
                  <g id="Group-2" fill="#B283D2" stroke="#979797">
                    <polygon
                      id="Amerika"
                      points="56.4710762 170.75972 41.1687607 126.090909 56.4710762 106.845455 62.0733601 59.7272727 0.262283497 67.0272727 56.4710762 32.4030704 181.046666 32.4030704 155.486457 59.7272727 164.74358 72.4084231 181.046666 54.8683451 220.979421 59.7272727 229.438633 86.2727273 186.571187 106.845455 155.486457 139.363636 141.918584 158.321224 127.505466 146 99.2201875 148.654545 99.2201875 182.580871 114.850458 170.75972 141.918584 219 74.3598414 182.580871 62.0733601 158.321224"
                    />
                    <polygon
                      id="Path-7"
                      points="121.281082 19.6932131 150.465702 19.6932131 135.873392 28.1020031"
                    />
                    <polygon
                      id="Path-8"
                      points="154.605897 24.9696671 157.479497 30.4661215 170.465016 27.7178943"
                    />
                    <polygon
                      id="Path-9"
                      points="191.296525 26.1446555 214.208917 39.5067049 202.752721 46.0284295 214.208917 51.5847711 229.645413 41.2841593 219.118033 26.1446555 198.245933 18.1796476"
                    />
                    <polygon
                      id="Path-10"
                      points="183.94479 40.4780766 196.748844 32.483125 196.748844 43.9790868"
                    />
                    <polygon
                      id="Path-11"
                      points="206.007159 10.6181818 209.574387 18.5162141 241.088476 6.85496333 206.007159 8.78453142"
                    />
                    <polygon
                      id="Path-12"
                      points="240.281433 10.6181818 255.359773 24.4857779 250.328884 45.1888098 262.453637 59.7272727 284.297532 42.5274192 321.044271 24.4857779 339.467782 4.8978471 272.31246 0.183520591"
                    />
                    <polygon
                      id="Path-13"
                      points="128.410415 171.804888 141.30162 166.9109 153.693795 178.106227"
                    />
                    <polygon
                      id="Path-14"
                      points="155.618283 184.350075 162.938978 178.085866 171.165807 184.350075"
                    />
                  </g>
                  <text
                    id="Noord--Amerika"
                    font-family="Roboto-Bold, Roboto"
                    font-size="20"
                    font-weight="bold"
                    letter-spacing="-1.037804"
                    fill="#FFFFFF"
                  >
                    <tspan x="64" y="95">Noord-</tspan>
                    <tspan x="64" y="121">Amerika</tspan>
                  </text>
                </g>
                <g
                  id="Zuid-Amerika"
                  v-on:click="targeted"
                  transform="translate(170.000000, 219.000000)"
                >
                  <polygon
                    id="Amerika"
                    stroke="#979797"
                    fill="#929DC8"
                    points="-7.10542736e-15 32.9471382 10.1246339 3.59914948 61.2431337 0 76.4998898 3.59914948 84.4959408 23.6415966 125.570131 42.2526797 125.570131 47.5767976 110.241657 89.5896138 97.393661 103.546166 89.6385816 124.834569 67.1278142 144.884502 64.0516008 171.98285 76.4998898 195.129434 31.078648 157.652547 33.300942 87.4510246 23.3551244 77.0511993"
                  />
                  <text
                    id="Zuid--Amerika"
                    font-family="Roboto-Bold, Roboto"
                    font-size="20"
                    font-weight="bold"
                    letter-spacing="-1.037804"
                    fill="#FFFFFF"
                  >
                    <tspan x="36" y="67">Zuid-</tspan>
                    <tspan x="36" y="93">Amerika</tspan>
                  </text>
                </g>
                <g id="Afrika" v-on:click="targeted" transform="translate(304.000000, 126.000000)">
                  <g id="Group-4" fill="#97BB88" stroke="#979797">
                    <polygon
                      id="Afrika"
                      points="31.726098 5.32544379 0.619087212 46.6873808 3.64744824 97.2679421 31.726098 104.298539 71.3819436 99.6916448 75.2210197 133.801775 86.0094117 153.714886 75.2210197 172.22031 96.6375059 222.786929 125.173985 224.356642 137.97129 204.509236 141.336391 169.480573 157.754813 158.11845 157.754813 128.476331 184.938563 80.2950517 162.462266 82.2388938 131.798092 29.8492697 134.395148 22.6331361 112.561196 13.3136095 98.8793695 19.9704142 76.6959907 13.3136095 75.2210197 1.7283807e-31"
                    />
                    <polygon
                      id="Path-17"
                      points="180.999156 156.434911 161.800316 169.784988 157.497645 179.068047 166.174487 195.103735 177.669804 169.784988"
                    />
                  </g>
                  <text
                    id="Afrika"
                    font-family="Roboto-Bold, Roboto"
                    font-size="20"
                    font-weight="bold"
                    letter-spacing="-1.037804"
                    fill="#FFFFFF"
                  >
                    <tspan x="61" y="87">Afrika</tspan>
                  </text>
                </g>
                <g id="Europa" v-on:click="targeted" transform="translate(327.000000, 26.000000)">
                  <g id="Group-3" fill="#E89A76" stroke="#979797">
                    <polygon
                      id="Eurazië"
                      points="2.7955602 78.3640749 0.315805257 96.0264901 11.7981988 100 47.4564763 78.3640749 63.6186302 96.0264901 69.2553191 89.4039735 60.6380891 76.1589404 77.5865349 85.4304636 82.0314439 100 91.7892911 88.0794702 103.539922 82.6964082 107.317116 67.5496689 123.609359 80.794702 117.601076 21.1409794 115.587571 14.9904069 91.7892911 0.580890552 69.2553191 7.28745352 41.2421229 26.7078197 41.2421229 33.7748344 51.7701447 33.7748344 63.6186302 43.2014334 77.5865349 14.9904069 77.5865349 29.8692209 86.8528058 29.8692209 77.5865349 43.2014334 51.7701447 48.214595 44.0776087 39.1904418 44.0776087 48.214595 19.3076889 62.9139073 19.3076889 78.3640749"
                    />
                    <polygon
                      id="Path-19"
                      points="21.7747802 33.7748344 18.3268387 47.0008944 16.3662897 56.3094004 26.5903861 53.6423841 26.5903861 39.4979126"
                    />
                    <polygon
                      id="Path-20"
                      points="11.2571195 44.7977388 6.9353925 53.6423841 11.2571195 53.6423841 14.1662842 49.2200614"
                    />
                  </g>
                  <text
                    id="Europa"
                    font-family="Roboto-Bold, Roboto"
                    font-size="20"
                    font-weight="bold"
                    letter-spacing="-1.037804"
                    fill="#FFFFFF"
                  >
                    <tspan x="41" y="69">Europa</tspan>
                  </text>
                </g>
                <g id="Azië" v-on:click="targeted" transform="translate(420.000000, 11.000000)">
                  <g id="1234" fill="#F696AC" stroke="#979797">
                    <polygon
                      id="Azië"
                      points="15.9353896 89.8834197 8.42482323 105.196891 0.347704706 107.860104 4.9008918 119.84456 26.02948 119.84456 22.7974787 143.219931 50.5550734 192.151488 96.3073344 164.247043 83.5685646 151.91828 68.4424293 155.503372 63.9180891 138.487047 86.8328743 149.639394 107.896846 155.503372 120.944854 167.441668 125.583427 164.247043 139.304144 209.062176 148.921684 202.382653 148.921684 185.815696 173.170348 164.247043 186.387976 182.206201 195.41704 177.76943 198.418267 205.818995 213.130161 223.66659 204.374565 202.382653 204.374565 192.151488 214.722507 209.062176 225.158144 197.133428 221.881142 185.815696 213.130161 171.921579 231.960232 164.247043 246.104421 160.331914 251.317624 145.705672 251.317624 135.823834 236.861889 118.298608 231.960232 107.860104 246.104421 111.854922 260.42169 129.165803 260.42169 107.860104 269.200364 89.8834197 263.240604 69.2435233 243.531281 62.8313771 257.632776 49.2694301 288.894687 44.8559503 288.894687 62.8313771 305.150465 78.5647668 296.791801 49.2694301 307.669372 51.9326425 315.974957 44.8559503 305.150465 36.5271499 315.974957 29.2337843 221.881142 20.5575148 123.909156 0 100.17512 11.6162855 77.7311156 11.6162855 68.4424293 24.1635239 29.1010928 24.1635239 29.1010928 36.5271499 35.7739465 99.6294047 30.7361323 99.6294047"
                    />
                    <polygon
                      id="Path-22"
                      points="189.585361 218.505686 214.89905 249.676166 218.728758 240.354922 211.976287 226.711303"
                    />
                    <polygon
                      id="Path-23"
                      points="219.085305 253.455968 234.850687 249.676166 243.105502 256.595731"
                    />
                    <polygon
                      id="Path-24"
                      points="227.465893 223.596864 233.511039 240.354922 248.423707 242.352332 254.817324 212.854373 248.423707 209.062176 237.103049 223.596864"
                    />
                    <polygon
                      id="Path-25"
                      points="254.284234 233.686252 254.284234 249.676166 259.622055 241.681209 265.400657 247.248007 265.400657 237.984875 272.689679 226.060525"
                    />
                    <polygon
                      id="Path-26"
                      points="267.096852 207.019448 270.570013 214.439483 274.858963 209.062176 274.858963 202.293171"
                    />
                    <polygon
                      id="Path-27"
                      points="259.968218 174.601391 255.538495 188.437403 259.968218 196.401303 268.099568 200.770814 273.126998 196.401303 262.05096 187.686103"
                    />
                    <polygon
                      id="Path-28"
                      points="274.194331 119.84456 271.149257 129.165803 281.33335 129.165803 292.139381 115.849741 285.788458 101.867876 292.139381 101.867876 296.316405 91.880829 281.33335 94.3592624 285.788458 115.751416"
                    />
                    <polygon
                      id="Path-29"
                      points="266.200291 67.7215113 277.379023 89.8834197 281.697974 84.5569948"
                    />
                  </g>
                  <text
                    id="Azië"
                    font-family="Roboto-Bold, Roboto"
                    font-size="20"
                    font-weight="bold"
                    letter-spacing="-1.037804"
                    fill="#FFFFFF"
                  >
                    <tspan x="115" y="100">Azië</tspan>
                  </text>
                </g>
                <g
                  id="Oceanië"
                  v-on:click="targeted"
                  transform="translate(652.000000, 246.000000)"
                >
                  <g id="Group-6" fill="#F6F88D" stroke="#979797">
                    <polygon
                      id="Oceanië"
                      points="0.601976907 101.13062 3.59288654 67.1568528 47.3776184 36.6666667 53.0392541 40 58.2092333 32 71.2836511 32 71.2836511 43.0063822 80.6994777 46.6666667 87.7875239 30 100.57666 65.5653101 110.692034 77.1733042 84.8466903 115.612624 65.1349115 115.612624 62.661455 108.666667 53.0392541 108.666667 44.9982444 90.4273964"
                    />
                    <polygon
                      id="Path-31"
                      points="64.7646517 123.333333 74.5568079 123.333333 67.2623875 134.354763"
                    />
                    <polygon
                      id="Path-32"
                      points="108.641949 140 116.965205 130.540724 133.604132 124.666667 125.006215 138"
                    />
                    <polygon
                      id="Path-33"
                      points="143.194466 124.666667 143.194466 118.666667 147.745323 110.668784 150.287065 98.7177192 155.026086 111.692193 162.576957 111.692193"
                    />
                    <polygon
                      id="Path-35"
                      points="60.2835984 0 70.7904773 14 83.7465333 20.9285396 93.7283718 20.9285396 107.153322 26.9515467 103.780013 20.9285396 107.153322 17.1359149 87.8846412 4.66666667 75.584127 2.36877741"
                    />
                  </g>
                  <text
                    id="Australië"
                    font-family="Roboto-Bold, Roboto"
                    font-size="20"
                    font-weight="bold"
                    letter-spacing="-1.037804"
                    fill="#8A8A8A"
                  >
                    <tspan x="22" y="75">Australië</tspan>
                  </text>
                </g>
                <path d id="Path-34" stroke="#979797" />
              </g>
            </g>
          </g>
        </svg>
      </div>
    </div>
    <div>
      <!-- {{selectedContinent}} -->
    </div>

    <div class="container-info">
      <div class="content" v-for="result in continents.items" v-bind:result="result" v-bind:key="result">
        <!-- <h2>{{result.title}}</h2> -->
        <div class="image">
          <img v-bind:src="result.img" alt="data" />
          <!-- {{result.img.value}} -->
        </div>
        <!-- <p>{{result.typeLabel}}</p> -->
      </div>
    </div>

  </div>
</template>


<script>
import _ from "lodash";

export default {
  name: "Map",
  props: ["this.results"],
  data() {
    return {
      image: null,
      results: [],
      continents:[],
      src: require,
      endpoints: {
        nmvw:
          "https://api.data.netwerkdigitaalerfgoed.nl/datasets/ivo/NMVW/services/NMVW-12/sparql"
      },
      continenten: ["Azië", "Afrika", "Eurazië", "Oceanië", "Amerika"]
    };
  },
  // Laurens code voor het ophalen van de api met SparQL
  mounted() {
    const url =
      "https://api.data.netwerkdigitaalerfgoed.nl/datasets/ivo/NMVW/services/NMVW-12/sparql";
    //Note that the query is wrapped in es6 template strings to allow for easy copy pasting
    const query = `
    PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
    PREFIX dc: <http://purl.org/dc/elements/1.1/>
    PREFIX dct: <http://purl.org/dc/terms/>
    PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
    PREFIX edm: <http://www.europeana.eu/schemas/edm/>
    PREFIX foaf: <http://xmlns.com/foaf/0.1/>

    SELECT ?cho ?title ?typeLabel ?img ?continentLabel WHERE {
    <https://hdl.handle.net/20.500.11840/termmaster14607>  skos:narrower* ?type . #de termmaster van rookgerei
          ?type skos:prefLabel ?typeLabel . #hier wil ik de naam terug krijgen van het type 
        ?cho edm:isShownBy ?img . #ophalen van de img linkjes
          ?cho edm:object ?type;
               dc:title ?title .  # hier wil ik de titel van het voorwerp
  <https://hdl.handle.net/20.500.11840/termmaster2> skos:narrower ?continent .
  ?continent skos:prefLabel ?continentLabel .
  ?continent skos:narrower* ?place .
  ?cho dct:spatial ?place .

    }
    `;
    this.fetchSparqlData(this.endpoints.nmvw, query)
      //Extract the nested data from that json. This nesting will be different for every API btw
      .then(json => json.results.bindings)
      //Rewrite each result to be flat and only contain interesting values
      .then(results => {
        // console.log('results:', results)

        return results.map((result, id) => {
          return {
            // 	//I've added an id value because that helps Vue distinguish different items later on
            id: id,
            cho: result.cho.value,
            continentLabel: result.continentLabel.value,
            title: result.title.value,
            typeLabel: result.typeLabel.value,
            img: result.img.value
            // 	//If you're confused about this next line, try experimentig with split+pop on a string
            // 	// in your browser
          };
        });
      })
      //Store the results in app.data
      .then(results => {
        this.results = results;
  
      });
  },
  methods: {
    // Fetch some data from a url and return the results
    fetchSparqlData: async function(endpoint, query) {
      // console.log("fetching", endpoint, query)
      const response = await fetch(
        endpoint + "?query=" + encodeURIComponent(query) + "&format=json"
      );
      //Extract the json from the html response
      const data = response.json();

      return data;
    },
    targeted() {
      const targetContinent = event.target.id;

      console.log(targetContinent);
      // console.log(this.results)

      let groupContinent = _.chain(this.results)
        .groupBy("continentLabel")
        .map((value, key) => ({
          continentLabel: key,
          items: value
        }))
        .value();
     groupContinent.filter(data => {
        if (targetContinent === data.continentLabel) {
          console.log(data);
          this.continents = data
        }
      });
    }
  }
};
</script>


<style scoped>
svg #Zuid-Amerika:hover polygon {
  fill: navy;
  cursor: pointer;
}

svg #Noord-Amerika:hover polygon {
  fill: purple;
  cursor: pointer;
}
svg #Europa:hover polygon {
  fill: orangered;
  cursor: pointer;
}
svg #Afrika:hover polygon {
  fill: green;
  cursor: pointer;
}
svg #Azië:hover polygon {
  fill: palevioletred;
  cursor: pointer;
}
svg #Oceanië:hover polygon {
  fill: yellowgreen;
  cursor: pointer;
}

.map-contain {
  width: 100vw;
  text-align: -webkit-center;
}
.map-static {
  display: block;
  position: relative;
  width: 80vw;
  justify-content: center;
}
.hover-click:hover {
  border: darkslategrey solid 0.2em;
}
.noord {
}
.zuid {
}
.eu {
}
.af {
}
.az {
}
.au {
}
</style>